
<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Test - Fixed</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        #map { height: 400px; width: 100%; border: 1px solid #ccc; }
        .info { margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
    </style>
</head>
<body>
    <h1>üó∫Ô∏è Prueba de Google Maps - Versi√≥n Corregida</h1>
    <div class="info">
        <strong>API Key:</strong> AIzaSyAR95HjXMWUpAZ7...<br>
        <strong>Proveedor:</strong> GOOGLE<br>
        <strong>Tienda:</strong> Test Store
    </div>
    <div id="map"></div>
    <div class="info" id="status">
        <strong>Estado:</strong> Cargando Google Maps...
    </div>

    <script>
        let map;
        let marker;
        let isInitialized = false;
        
        function initMap() {
            if (isInitialized) {
                console.log('‚ö†Ô∏è Google Maps ya inicializado, evitando duplicaci√≥n');
                return;
            }
            
            console.log('üó∫Ô∏è Inicializando Google Maps...');
            isInitialized = true;
            
            try {
                // Centro en Ciudad de M√©xico
                const center = { lat: 19.4326, lng: -99.1332 };
                
                // Crear mapa
                map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 15,
                    center: center,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    streetViewControl: false,
                    fullscreenControl: true,
                    zoomControl: true,
                    mapTypeControl: true,
                    scaleControl: true
                });
                
                // Crear marcador
                marker = new google.maps.Marker({
                    position: center,
                    map: map,
                    draggable: true,
                    title: 'Ubicaci√≥n seleccionada'
                });
                
                // Evento cuando se arrastra el marcador
                marker.addListener('dragend', function() {
                    const position = marker.getPosition();
                    console.log('üìç Marcador movido:', position.lat(), position.lng());
                    updateInfo(position.lat(), position.lng());
                });
                
                // Evento cuando se hace clic en el mapa
                map.addListener('click', function(event) {
                    const lat = event.latLng.lat();
                    const lng = event.latLng.lng();
                    marker.setPosition({ lat, lng });
                    console.log('üñ±Ô∏è Clic en mapa:', lat, lng);
                    updateInfo(lat, lng);
                });
                
                console.log('‚úÖ Google Maps inicializado correctamente');
                updateStatus('success', '‚úÖ Google Maps funcionando correctamente');
                
            } catch (error) {
                console.error('‚ùå Error inicializando Google Maps:', error);
                updateStatus('error', '‚ùå Error: ' + error.message);
            }
        }
        
        function updateInfo(lat, lng) {
            const info = document.getElementById('status');
            info.innerHTML = `<strong>Coordenadas:</strong> ${lat.toFixed(6)}, ${lng.toFixed(6)}<br>
                            <strong>Estado:</strong> ‚úÖ Google Maps funcionando correctamente`;
            info.className = 'info success';
        }
        
        function updateStatus(type, message) {
            const status = document.getElementById('status');
            status.innerHTML = `<strong>Estado:</strong> ${message}`;
            status.className = `info ${type}`;
        }
        
        // Verificar si Google Maps ya est√° cargado
        if (window.google && window.google.maps) {
            console.log('‚úÖ Google Maps ya cargado');
            initMap();
        } else {
            // Cargar Google Maps
            const script = document.createElement('script');
            script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyAR95HjXMWUpAZ7PqquoMzBN9Of6EJ4dA4&libraries=places&callback=initMap';
            script.async = true;
            script.defer = true;
            script.onerror = function() {
                updateStatus('error', '‚ùå Error cargando Google Maps API');
            };
            document.head.appendChild(script);
        }
    </script>
</body>
</html>
    